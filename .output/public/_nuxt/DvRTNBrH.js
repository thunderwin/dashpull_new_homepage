import{d as R,A as U,u as N,x as n,X as r,a6 as V,z as X,F as Y,am as s,ag as o,al as m,a3 as A,J as D,an as G,W as I,L as q}from"./B_AaASQX.js";import{ae as J,R as Q,aF as E}from"./BaS4CksA.js";const Z=["width","height"],K={__name:"CandlestickBar",props:{data:{type:Object,required:!1,default:()=>({o:0,h:0,l:0,c:0})},width:{type:Number,default:40},height:{type:Number,default:36}},setup(w){const y=w,i=R(null),$=()=>{const k=i.value;if(!k)return;const e=k.getContext("2d"),{o:l,h:x,l:f,c}=y.data;if(typeof l!="number"||typeof x!="number"||typeof f!="number"||typeof c!="number"||l===0&&x===0&&f===0&&c===0)return;const M=2,a=y.width*M,d=y.height*M;e.clearRect(0,0,a,d),e.imageSmoothingEnabled=!0,e.imageSmoothingQuality="high";const p=x-f;if(p===0){const B=d/2,H=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches;e.strokeStyle=H?"#64748b":"#475569",e.lineWidth=6,e.lineCap="round",e.beginPath(),e.moveTo(6,B),e.lineTo(a-6,B),e.stroke();return}const t=6,h=Math.max(12,a*.35),_=d-t*2,u=a/2,v=u-h/2,z=u+h/2,g=B=>t+(x-B)/p*_,W=c>=l,C=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,P=W?C?"#22c55e":"#16a34a":C?"#ef4444":"#dc2626",F=W?C?"#22c55e":"#15803d":C?"#ef4444":"#b91c1c",L=W?C?"#16a34a":"#14532d":C?"#dc2626":"#991b1b";e.strokeStyle=L,e.lineWidth=6,e.beginPath(),e.moveTo(u,g(x)),e.lineTo(u,g(Math.max(l,c))-1),e.moveTo(u,g(Math.min(l,c))+1),e.lineTo(u,g(f)),e.stroke(),e.strokeStyle=F,e.lineWidth=5,e.lineCap="round",e.beginPath(),e.moveTo(u,g(x)),e.lineTo(u,g(Math.max(l,c))-1),e.moveTo(u,g(Math.min(l,c))+1),e.lineTo(u,g(f)),e.stroke(),e.shadowColor="transparent",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0;const b=g(Math.max(l,c)),O=g(Math.min(l,c)),T=Math.max(2,O-b);e.shadowColor="rgba(0, 0, 0, 0.15)",e.shadowBlur=3,e.shadowOffsetX=1,e.shadowOffsetY=1;const j=e.createLinearGradient(v,b,v+h,b+T);j.addColorStop(0,P),j.addColorStop(1,P+"88"),e.fillStyle=j;const S=2;e.beginPath(),typeof e.roundRect=="function"?e.roundRect(v,b,h,T,S):e.rect(v,b,h,T),e.fill(),e.shadowColor="transparent",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0,e.strokeStyle=P,e.lineWidth=2,e.beginPath(),typeof e.roundRect=="function"?e.roundRect(v,b,h,T,S):e.rect(v,b,h,T),e.stroke(),l===c&&(e.strokeStyle=P,e.lineWidth=6,e.lineCap="round",e.beginPath(),e.moveTo(v-3,g(l)),e.lineTo(z+3,g(l)),e.stroke())};return U(()=>y.data,$,{deep:!0}),N(()=>{$()}),(k,e)=>(r(),n("canvas",{ref_key:"canvasRef",ref:i,width:w.width*2,height:w.height*2,style:V({width:w.width+"px",height:w.height+"px"})},null,12,Z))}},tt={class:"min-h-screen bg-gray-50 dark:bg-gray-900 py-8"},et={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},st={class:"text-center mb-8"},at={class:"text-4xl font-bold text-gray-900 dark:text-white mb-4"},ot={class:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-7 gap-4 mb-8"},rt={class:"bg-white dark:bg-gray-800 rounded-lg p-4 text-center shadow-sm"},nt={class:"text-2xl font-bold text-gray-900 dark:text-white"},dt={class:"text-sm text-gray-600 dark:text-gray-300"},it={class:"bg-white dark:bg-gray-800 rounded-lg p-4 text-center shadow-sm"},lt={class:"text-2xl font-bold text-blue-600"},ct={class:"text-sm text-gray-600 dark:text-gray-300"},ht={class:"bg-white dark:bg-gray-800 rounded-lg p-4 text-center shadow-sm"},gt={class:"text-2xl font-bold text-orange-600"},xt={class:"text-sm text-gray-600 dark:text-gray-300"},ut={class:"bg-white dark:bg-gray-800 rounded-lg p-4 text-center shadow-sm"},yt={class:"text-2xl font-bold text-green-600"},pt={class:"text-sm text-gray-600 dark:text-gray-300"},_t={class:"bg-white dark:bg-gray-800 rounded-lg p-4 text-center shadow-sm"},mt={class:"text-2xl font-bold text-red-600"},ft={class:"text-sm text-gray-600 dark:text-gray-300"},kt={class:"bg-white dark:bg-gray-800 rounded-lg p-4 text-center shadow-sm"},vt={class:"text-2xl font-bold text-blue-600"},bt={class:"text-sm text-gray-600 dark:text-gray-300"},wt={class:"bg-white dark:bg-gray-800 rounded-lg p-4 text-center shadow-sm"},$t={class:"text-sm text-gray-600 dark:text-gray-300"},Ct={key:0,class:"flex items-center justify-center py-12"},Rt={class:"ml-3 text-gray-600 dark:text-gray-300"},Mt={key:1,class:"text-center py-12"},Tt={class:"text-red-600 dark:text-red-400 mb-4"},Pt={key:2,class:"bg-white dark:bg-gray-800 rounded-lg shadow-sm overflow-hidden"},Bt={class:"overflow-x-auto"},Wt={class:"min-w-full divide-y divide-gray-200 dark:divide-gray-700"},jt={class:"bg-gray-50 dark:bg-gray-700 hidden md:table-header-group"},St={class:"w-1/6 px-4 py-4 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},At={class:"w-1/6 px-4 py-4 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},Dt={class:"w-1/6 px-4 py-4 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},Et={class:"w-1/6 px-4 py-4 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},Nt={class:"w-1/6 px-4 py-4 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},zt={class:"w-1/6 px-4 py-4 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},Ft={class:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700"},Lt={class:"px-4 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white"},Ot={class:"px-4 py-4 whitespace-nowrap text-center"},Ht={key:0,class:"text-gray-400 text-xs"},Ut={key:1,class:"text-orange-500 text-xs"},Vt={key:2,class:"text-gray-400 text-xs"},Xt={class:"px-4 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white text-center"},Yt={class:"px-4 py-4 whitespace-nowrap text-center"},Gt={class:"flex justify-center"},It={key:1,class:"text-gray-400 text-xs"},qt={class:"px-4 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white text-center"},Jt={key:0,class:"text-gray-400"},Qt={key:1,class:"text-gray-400"},Zt={key:3,class:"text-gray-400"},Kt={class:"px-4 py-4 whitespace-nowrap text-center"},te={key:0,class:"text-gray-400 text-xs"},ee={key:1,class:"text-orange-500 text-xs"},se={key:3,class:"text-gray-400 text-xs"},ae={key:1,class:"px-3 py-3 w-full",colspan:"6"},oe={class:"flex flex-col space-y-2"},re={class:"flex items-center justify-between"},ne={class:"text-sm font-medium text-gray-900 dark:text-white"},de={class:"flex items-center space-x-2"},ie={key:0,class:"text-gray-400 text-xs"},le={key:1,class:"text-orange-500 text-xs"},ce={key:2,class:"text-gray-400 text-xs"},he={class:"flex items-center justify-between text-sm"},ge={class:"flex items-center space-x-4"},xe={class:"flex items-center space-x-1"},ue={class:"flex items-center space-x-1"},ye={key:0,class:"text-gray-400"},pe={key:1,class:"text-gray-400"},_e={key:3,class:"text-gray-400"},me={key:0,class:"text-gray-400 text-xs"},fe={key:1,class:"text-orange-500 text-xs"},ke={key:3,class:"text-gray-400 text-xs"},ve={key:0,class:"flex justify-center pt-2"},be={key:0,class:"text-center py-12"},we={class:"text-gray-600 dark:text-gray-300"},Re={__name:"predictions",setup(w){const y=R([]),i=R({totalRecords:0,tradedCount:0,eventCount:0,longCount:0,shortCount:0,winRate:0,averageProfitRate:null}),$=R(!0),k=R(!1),e=R(0),l=X(()=>e.value<768),x=()=>{e.value=window.innerWidth},f=a=>{try{const{$t:d}=E();return d(`predictions.events.${a}`,a)}catch(d){return console.warn("Translation error for event:",a,d),a||"Unknown Event"}},c=async()=>{$.value=!0,k.value=!1;try{const a=Q(),p=`${a.public.strapiApiUrl||"https://api.dashpull.com"}/api/human-predicts-statistics`,t=a.public.strapiApiToken||"d500bca2021bcb781b01959a2b5c7eca35104ead14e5a1c7a113e1b77030a9d798e3d0ea3be290c20050d000ac5d7c6cc021e57eda01e40b3c545e2d8da2b6c4b75ead96fa5e3ac2cae31ae76de74415371a7928094e271535d1ef786a1f2216e745df26d4aacf85021f5b86c9f2fe92644a9fa5a1f9d63699e43340409661ff",h={"Content-Type":"application/json"};t&&(h.Authorization=`Bearer ${t}`);const _=await $fetch(p,{method:"GET",headers:h,retry:3,timeout:1e4});if(_&&typeof _=="object")y.value=Array.isArray(_.predictions)?_.predictions:[],i.value=_.statistics&&typeof _.statistics=="object"?_.statistics:{totalRecords:0,tradedCount:0,eventCount:0,longCount:0,shortCount:0,winRate:0,averageProfitRate:null};else throw new Error("Invalid response format")}catch(a){console.error("Failed to fetch predictions:",a),k.value=!0,y.value=[],i.value={totalRecords:0,tradedCount:0,eventCount:0,longCount:0,shortCount:0,winRate:0,averageProfitRate:null}}finally{$.value=!1}},M=a=>{try{if(!a)return"";const d=new Date(a);if(isNaN(d.getTime()))return a;const{$i18n:p}=E();return d.toLocaleDateString(p.locale,{year:"numeric",month:"short",day:"numeric"})}catch(d){return console.warn("Date formatting error:",d),a||""}};return N(()=>{c(),x(),window.addEventListener("resize",x)}),Y(()=>{window.removeEventListener("resize",x)}),J({title:"预测历史 - DashPull",meta:[{name:"description",content:"AI 预测历史记录，查看最近100次预测结果和统计数据"}]}),(a,d)=>{const p=K;return r(),n("div",tt,[s("div",et,[s("div",st,[s("h1",at,o(a.$t("predictions.title")),1)]),s("div",ot,[s("div",rt,[s("div",nt,o(i.value.totalRecords||0),1),s("div",dt,o(a.$t("predictions.total_records")),1)]),s("div",it,[s("div",lt,o(i.value.tradedCount||0),1),s("div",ct,o(a.$t("predictions.trading_count")),1)]),s("div",ht,[s("div",gt,o(i.value.eventCount||0),1),s("div",xt,o(a.$t("predictions.event_predictions")),1)]),s("div",ut,[s("div",yt,o(i.value.longCount||0),1),s("div",pt,o(a.$t("predictions.long_predictions")),1)]),s("div",_t,[s("div",mt,o(i.value.shortCount||0),1),s("div",ft,o(a.$t("predictions.short_predictions")),1)]),s("div",kt,[s("div",vt,o(i.value.winRate||0)+"%",1),s("div",bt,o(a.$t("predictions.win_rate")),1)]),s("div",wt,[s("div",{class:m(["text-2xl font-bold",(i.value.averageProfitRate||0)>=0?"text-green-600":"text-red-600"])},o(i.value.averageProfitRate!==null?((i.value.averageProfitRate||0)>=0?"+":"")+(i.value.averageProfitRate||0).toFixed(2)+"%":"-"),3),s("div",$t,o(a.$t("predictions.average_profit_rate")),1)])]),$.value?(r(),n("div",Ct,[d[0]||(d[0]=s("div",{class:"w-8 h-8 border-2 border-blue-600 border-t-transparent rounded-full animate-spin"},null,-1)),s("span",Rt,o(a.$t("prediction_component.loading")),1)])):k.value?(r(),n("div",Mt,[s("p",Tt,o(a.$t("prediction_component.error")),1),s("button",{onClick:c,class:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors"},o(a.$t("common.refresh")),1)])):(r(),n("div",Pt,[s("div",Bt,[s("table",Wt,[s("thead",jt,[s("tr",null,[s("th",St,o(a.$t("predictions.date")),1),s("th",At,o(a.$t("predictions.prediction")),1),s("th",Dt,o(a.$t("predictions.long_short_score")),1),s("th",Et,o(a.$t("predictions.chart")),1),s("th",Nt,o(a.$t("predictions.profit_rate")),1),s("th",zt,o(a.$t("predictions.result")),1)])]),s("tbody",Ft,[(r(!0),n(D,null,G(y.value,(t,h)=>(r(),n("tr",{key:h,class:"hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors"},[l.value?(r(),n("td",ae,[s("div",oe,[s("div",re,[s("div",ne,o(M(t.day)),1),s("div",de,[Math.abs(t.market_score||0)<.15?(r(),n("span",ie,o(a.$t("predictions.no_direction")),1)):t.events&&t.events!=="none"?(r(),n("span",le,o(f(t.events)),1)):t.side?(r(),n("span",{key:3,class:m(["inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium",t.side==="long"?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200"])},o(t.side==="long"?a.$t("prediction_component.side_long"):a.$t("prediction_component.side_short")),3)):(r(),n("span",ce,o(a.$t("predictions.hidden")),1))])]),s("div",he,[s("div",ge,[s("div",xe,[d[1]||(d[1]=s("span",{class:"text-gray-500 dark:text-gray-400"},"评分:",-1)),s("span",{class:m((t.market_score||0)>0?"text-green-600":"text-red-600")},o(t.market_score||"-"),3)]),s("div",ue,[d[2]||(d[2]=s("span",{class:"text-gray-500 dark:text-gray-400"},"收益:",-1)),Math.abs(t.market_score||0)<.15?(r(),n("span",ye,"-")):t.events&&t.events!=="none"?(r(),n("span",pe,"-")):t.profit_rate!==null&&t.profit_rate!==void 0?(r(),n("span",{key:2,class:m((t.profit_rate||0)>=0?"text-green-600":"text-red-600")},o(((t.profit_rate||0)>=0?"+":"")+(t.profit_rate||0).toFixed(2))+"% ",3)):(r(),n("span",_e,"-"))])]),s("div",null,[Math.abs(t.market_score||0)<.15?(r(),n("span",me,o(a.$t("predictions.break")),1)):t.events&&t.events!=="none"?(r(),n("span",fe,o(a.$t("predictions.event")),1)):t.result&&t.result!==null?(r(),n("span",{key:2,class:m(["inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium",t.result==="yes"?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":t.result==="no"?"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200":"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200"])},o(t.result==="yes"?"✓ "+a.$t("predictions.win"):t.result==="no"?"✗ "+a.$t("predictions.loss"):"⊕ "+a.$t("predictions.stop_loss")),3)):(r(),n("span",ke,o(a.$t("predictions.pending")),1))])]),t.spy_kline&&t.spy_kline.length>0?(r(),n("div",ve,[q(p,{data:t.spy_kline[0],width:36,height:32},null,8,["data"])])):A("",!0)])])):(r(),n(D,{key:0},[s("td",Lt,o(M(t.day)),1),s("td",Ot,[Math.abs(t.market_score||0)<.15?(r(),n("span",Ht,o(a.$t("predictions.no_direction")),1)):t.events&&t.events!=="none"?(r(),n("span",Ut,o(f(t.events)),1)):t.side?(r(),n("span",{key:3,class:m(["inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",t.side==="long"?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200"])},o(t.side==="long"?a.$t("prediction_component.side_long"):a.$t("prediction_component.side_short")),3)):(r(),n("span",Vt,o(a.$t("predictions.hidden")),1))]),s("td",Xt,[s("span",{class:m((t.market_score||0)>0?"text-green-600":"text-red-600")},o(t.market_score||"-"),3)]),s("td",Yt,[s("div",Gt,[t.spy_kline&&t.spy_kline.length>0?(r(),I(p,{key:0,data:t.spy_kline[0],width:40,height:36},null,8,["data"])):(r(),n("span",It,"-"))])]),s("td",qt,[Math.abs(t.market_score||0)<.15?(r(),n("span",Jt," - ")):t.events&&t.events!=="none"?(r(),n("span",Qt," - ")):t.profit_rate!==null&&t.profit_rate!==void 0?(r(),n("span",{key:2,class:m(t.profit_rate>=0?"text-green-600":"text-red-600")},o((t.profit_rate>=0?"+":"")+t.profit_rate.toFixed(2))+"% ",3)):(r(),n("span",Zt," - "))]),s("td",Kt,[Math.abs(t.market_score||0)<.15?(r(),n("span",te,o(a.$t("predictions.break")),1)):t.events&&t.events!=="none"?(r(),n("span",ee,o(a.$t("predictions.event")),1)):t.result&&t.result!==null?(r(),n("span",{key:2,class:m(["inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",t.result==="yes"?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":t.result==="no"?"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200":"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200"])},o(t.result==="yes"?"✓ "+a.$t("predictions.win"):t.result==="no"?"✗ "+a.$t("predictions.loss"):"⊕ "+a.$t("predictions.stop_loss")),3)):(r(),n("span",se,o(a.$t("predictions.pending")),1))])],64))]))),128))])])]),y.value.length===0?(r(),n("div",be,[d[3]||(d[3]=s("div",{class:"text-gray-400 mb-2"},[s("svg",{class:"w-12 h-12 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})])],-1)),s("p",we,o(a.$t("common.no_data")),1)])):A("",!0)]))])])}}};export{Re as default};
