import{a as T,t as k,P as D,i as E,e as U,C as P,F as S,R as I,b8 as C,b9 as $,ba as A}from"./CJvxXszI.js";import{ah as z,z as B,W as v,X as c,Y as m,x as l,a3 as _,al as f,Z as b,D as L,am as t,L as a,ag as i,af as x}from"./B_AaASQX.js";import{_ as j}from"./DlAUqK2U.js";const M={slots:{root:"rounded-lg",header:"p-4 sm:px-6",body:"p-4 sm:p-6",footer:"p-4 sm:px-6"},variants:{variant:{solid:{root:"bg-inverted text-inverted"},outline:{root:"bg-default ring ring-default divide-y divide-default"},soft:{root:"bg-elevated/50 divide-y divide-default"},subtle:{root:"bg-elevated/50 ring ring-default divide-y divide-default"}}},defaultVariants:{variant:"outline"}},N={__name:"UCard",props:{as:{type:null,required:!1},variant:{type:null,required:!1},class:{type:null,required:!1},ui:{type:null,required:!1}},setup(e){const n=e,d=z(),h=T(),r=B(()=>{var s;return k({extend:k(M),...((s=h.ui)==null?void 0:s.card)||{}})({variant:n.variant})});return(s,o)=>{var p;return c(),v(L(D),{as:e.as,class:f(r.value.root({class:[(p=n.ui)==null?void 0:p.root,n.class]}))},{default:m(()=>{var u,g,y;return[d.header?(c(),l("div",{key:0,class:f(r.value.header({class:(u=n.ui)==null?void 0:u.header}))},[b(s.$slots,"header")],2)):_("",!0),d.default?(c(),l("div",{key:1,class:f(r.value.body({class:(g=n.ui)==null?void 0:g.body}))},[b(s.$slots,"default")],2)):_("",!0),d.footer?(c(),l("div",{key:2,class:f(r.value.footer({class:(y=n.ui)==null?void 0:y.footer}))},[b(s.$slots,"footer")],2)):_("",!0)]}),_:3},8,["as","class"])}}},w=window.setInterval,q={name:"PredictionComponent",data(){return{prediction:null,loading:!0,error:!1,currentTime:new Date,countdownInterval:null}},computed:{isPredictionTime(){const n=new Date(this.currentTime.toLocaleString("en-US",{timeZone:"Asia/Shanghai"})).getHours();return n>=20||n<8},predictionData(){return this.prediction?this.prediction:{market_score:0}},hasStopLoss(){return this.prediction&&(this.prediction.long_stoploss||this.prediction.short_stoploss)},hasEvent(){return this.prediction&&this.prediction.events&&this.prediction.events!=="none"&&Math.abs(this.predictionData.market_score||0)>=.15},shouldShowPrediction(){return!this.prediction||!this.predictionData.market_score||this.hasEvent?!1:Math.abs(this.predictionData.market_score)>=.15}},mounted(){this.fetchPrediction(),this.timeInterval=w(()=>{this.currentTime=new Date},6e4),this.countdownInterval=w(()=>{this.currentTime=new Date},1e3)},beforeUnmount(){this.timeInterval&&clearInterval(this.timeInterval),this.countdownInterval&&clearInterval(this.countdownInterval)},methods:{async fetchPrediction(){this.loading=!0,this.error=!1;try{const e=I(),n=e.public.strapiApiUrl||"https://api.dashpull.com",d=e.public.strapiApiToken,h=new Date().toISOString().split("T")[0],r=`${n}/api/human-predicts-statistics`,s={"Content-Type":"application/json"};d&&(s.Authorization=`Bearer ${d}`);const o=await $fetch(r,{method:"GET",headers:s,retry:3,timeout:1e4});if(o&&typeof o=="object"&&Array.isArray(o.predictions)){const p=o.predictions.find(u=>u&&u.day===h);this.prediction=p||null}else this.prediction=null}catch(e){console.error("Failed to fetch prediction:",e),this.error=!0,this.prediction=null}finally{this.loading=!1}},formatDate(e){try{if(!e)return"";const n=new Date(e);return isNaN(n.getTime())?e:n.toLocaleDateString(this.$i18n.locale,{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch(n){return console.warn("Date formatting error:",n),e||""}},formatTimeUntilPrediction(){try{const e=new Date(this.currentTime.toLocaleString("en-US",{timeZone:"Asia/Shanghai"})),n=e.getHours(),d=e.getMinutes(),h=e.getSeconds();if(n<20){const r=19-n,s=59-d,o=60-h;return this.$i18n.locale==="zh"?`${r}时${s}分${o}秒`:`${r}h ${s}m ${o}s`}return""}catch(e){return console.warn("Time formatting error:",e),""}},translateEvent(e){try{return e?this.$t(`predictions.events.${e}`,e):"Unknown Event"}catch(n){return console.warn("Translation error for event:",e,n),e||"Unknown Event"}},goToPredictionHistory(){try{const e=S();this.$router.push(e("/prediction-history"))}catch(e){console.error("Navigation error:",e),this.$router.push("/prediction-history")}}}},H={key:0,class:"flex items-center justify-center"},V={class:"flex items-center space-x-3"},O={class:"text-lg font-medium text-gray-600 dark:text-gray-300"},F={key:1,class:"flex items-center justify-between"},Z={class:"flex items-center space-x-3"},R={class:"text-lg font-medium text-red-600 dark:text-red-400"},G={key:2,class:"flex items-center justify-center"},W={class:"flex items-center justify-between w-full max-w-5xl"},X={class:"flex items-center space-x-3"},Y={class:"w-14 h-14 bg-primary/20 rounded-full flex items-center justify-center"},J={class:"text-xl font-bold text-gray-900 dark:text-white"},Q={class:"text-base text-gray-500 dark:text-gray-400"},K={class:"flex items-center"},ee={class:"bg-gradient-to-r from-amber-100 to-orange-100 dark:from-amber-900/30 dark:to-orange-900/30 border-2 border-amber-300 dark:border-amber-700 rounded-lg px-6 py-2 shadow-lg"},te={class:"text-center"},se={class:"text-xs font-medium text-amber-700 dark:text-amber-300 mb-1"},re={class:"text-2xl font-black text-amber-900 dark:text-amber-100 font-mono tracking-wider"},ne={key:3,class:"flex items-center justify-center"},oe={class:"flex items-center justify-between w-full max-w-6xl"},ie={class:"flex items-center space-x-4"},ae={class:"flex items-center space-x-3"},ce={class:"relative"},le={class:"text-base font-medium text-gray-600 dark:text-gray-300"},de={key:0,class:"flex items-center space-x-3 bg-blue-50 dark:bg-blue-950/50 border-2 border-blue-200 dark:border-blue-800 rounded-lg px-4 py-1 shadow-lg"},ue={class:"text-base font-bold text-blue-800 dark:text-blue-200"},he={class:"text-2xl font-black text-blue-900 dark:text-blue-100"},me={class:"text-right"},_e={class:"flex items-center justify-end space-x-2 text-sm text-gray-500 dark:text-gray-400 mb-1"},pe={key:0,class:"flex space-x-1 justify-end"},fe={key:4,class:"flex items-center justify-center"},ge={class:"flex items-center justify-between w-full max-w-5xl"},xe={class:"flex items-center space-x-4"},ve={class:"flex items-center space-x-3"},be={class:"w-14 h-14 bg-gray-100 dark:bg-gray-800 rounded-full flex items-center justify-center"},ye={class:"text-xl font-bold text-gray-700 dark:text-gray-300"},ke={class:"text-base text-gray-500 dark:text-gray-400"},we={class:"flex items-center space-x-3 bg-gray-50 dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-700 rounded-lg px-4 py-1 shadow-lg"},je={class:"text-base font-bold text-gray-600 dark:text-gray-300"},Te={class:"text-2xl font-black text-gray-900 dark:text-white"},De={key:5,class:"flex items-center justify-center"},Ee={class:"flex items-center space-x-3"},Ue={class:"w-10 h-10 bg-gray-100 dark:bg-gray-800 rounded-full flex items-center justify-center"},Pe={class:"text-lg font-medium text-gray-600 dark:text-gray-300"};function Se(e,n,d,h,r,s){const o=E,p=U,u=P,g=N;return c(),v(g,{class:"prediction-banner bg-gradient-to-r from-slate-50 to-blue-50 dark:from-slate-900 dark:to-blue-950 border-2 border-blue-200/30 dark:border-blue-800/30"},{default:m(()=>[r.loading?(c(),l("div",H,[t("div",V,[a(o,{name:"i-heroicons-arrow-path",class:"h-5 w-5 text-primary animate-spin"}),t("span",O,i(e.$t("prediction_component.loading")),1)])])):r.error?(c(),l("div",F,[t("div",Z,[a(o,{name:"i-heroicons-exclamation-triangle",class:"h-6 w-6 text-red-500"}),t("p",R,i(e.$t("prediction_component.error")),1)]),a(p,{onClick:s.fetchPrediction,color:"primary",size:"sm",loading:r.loading},{leading:m(()=>[a(o,{name:"i-heroicons-arrow-path"})]),default:m(()=>[x(" "+i(e.$t("common.refresh")),1)]),_:1},8,["onClick","loading"])])):s.isPredictionTime?r.prediction&&(s.shouldShowPrediction||s.hasEvent)?(c(),l("div",ne,[t("div",oe,[t("div",ie,[t("div",ae,[t("div",ce,[t("div",{class:f(["flex items-center justify-center w-14 h-14 rounded-full text-white shadow-lg",s.hasEvent?"bg-gradient-to-br from-orange-400 to-orange-600":r.prediction.side==="long"?"bg-gradient-to-br from-green-400 to-green-600":"bg-gradient-to-br from-red-400 to-red-600"])},[a(o,{name:s.hasEvent?"i-heroicons-exclamation-triangle":r.prediction.side==="long"?"i-heroicons-arrow-trending-up":"i-heroicons-arrow-trending-down",class:"h-7 w-7"},null,8,["name"])],2),t("div",{class:f(["absolute inset-0 rounded-full animate-ping opacity-20",s.hasEvent?"bg-orange-400":r.prediction.side==="long"?"bg-green-400":"bg-red-400"])},null,2)]),t("div",null,[a(u,{color:s.hasEvent?"orange":r.prediction.side==="long"?"green":"red",variant:"soft",size:"lg",class:"text-lg font-bold px-4 py-1 mb-1"},{default:m(()=>[x(i(s.hasEvent?s.translateEvent(r.prediction.events):r.prediction.side==="long"?e.$t("prediction_component.side_long"):e.$t("prediction_component.side_short")),1)]),_:1},8,["color"]),t("p",le,i(s.hasEvent?e.$t("predictions.event"):e.$t("prediction_component.current_prediction")),1)])]),s.hasEvent?_("",!0):(c(),l("div",de,[a(o,{name:"i-heroicons-chart-bar-square",class:"h-6 w-6 text-blue-600"}),t("span",ue,i(e.$t("prediction_component.market_score")),1),t("span",he,i(s.predictionData.market_score),1)]))]),t("div",me,[t("div",_e,[a(o,{name:"i-heroicons-clock",class:"h-5 w-5"}),t("span",null,i(s.formatDate(r.prediction.day)),1)]),s.hasStopLoss&&!s.hasEvent?(c(),l("div",pe,[r.prediction.long_stoploss?(c(),v(u,{key:0,color:"green",variant:"outline",size:"sm",class:"px-2 py-1 text-xs"},{default:m(()=>[x(" 多头止损: "+i(r.prediction.long_stoploss),1)]),_:1})):_("",!0),r.prediction.short_stoploss?(c(),v(u,{key:1,color:"red",variant:"outline",size:"sm",class:"px-2 py-1 text-xs"},{default:m(()=>[x(" 空头止损: "+i(r.prediction.short_stoploss),1)]),_:1})):_("",!0)])):_("",!0)])])])):r.prediction&&!s.shouldShowPrediction&&!s.hasEvent?(c(),l("div",fe,[t("div",ge,[t("div",xe,[t("div",ve,[t("div",be,[a(o,{name:"i-heroicons-minus-circle",class:"h-7 w-7 text-gray-400"})]),t("div",null,[t("h3",ye,i(e.$t("prediction_component.no_suggestion")),1),t("p",ke,i(e.$t("prediction_component.market_score_too_low")),1)])]),t("div",we,[a(o,{name:"i-heroicons-chart-bar-square",class:"h-6 w-6 text-gray-500"}),t("span",je,i(e.$t("prediction_component.market_score")),1),t("span",Te,i(s.predictionData.market_score),1)])]),n[0]||(n[0]=t("div",null,null,-1))])])):(c(),l("div",De,[t("div",Ee,[t("div",Ue,[a(o,{name:"i-heroicons-document-magnifying-glass",class:"h-5 w-5 text-gray-400"})]),t("p",Pe,i(e.$t("common.no_data")),1)])])):(c(),l("div",G,[t("div",W,[t("div",X,[t("div",Y,[a(o,{name:"i-heroicons-clock",class:"h-7 w-7 text-primary"})]),t("div",null,[t("h3",J,i(e.$t("prediction_component.no_prediction_yet")),1),t("p",Q,i(e.$t("prediction_component.waiting_for_prediction")),1)])]),t("div",K,[t("div",ee,[t("div",te,[t("p",se,i(e.$t("prediction_component.countdown_label")),1),t("div",re,i(s.formatTimeUntilPrediction()),1)])])])])]))]),_:1})}const Ie=Object.assign(j(q,[["render",Se],["__scopeId","data-v-96549798"]]),{__name:"MarketOverview"}),Ce={};function $e(e,n){const d=C,h=Ie,r=$,s=A;return c(),l("div",null,[a(d),a(h),a(r,null,{default:m(()=>[b(e.$slots,"default")]),_:3}),a(s)])}const Le=j(Ce,[["render",$e]]);export{Le as default};
