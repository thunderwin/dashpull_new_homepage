import{d as R,A as H,u as D,x as n,X as r,a6 as V,z as X,F as Y,am as e,ag as o,al as _,a3 as S,J as A,an as U,W as G,L as I}from"./B_AaASQX.js";import{ae as q,R as J,aF as Q}from"./CJvxXszI.js";const K=["width","height"],Z={__name:"CandlestickBar",props:{data:{type:Object,required:!1,default:()=>({o:0,h:0,l:0,c:0})},width:{type:Number,default:40},height:{type:Number,default:36}},setup(v){const y=v,i=R(null),C=()=>{const f=i.value;if(!f)return;const t=f.getContext("2d"),{o:c,h:x,l:m,c:h}=y.data;if(typeof c!="number"||typeof x!="number"||typeof m!="number"||typeof h!="number"||c===0&&x===0&&m===0&&h===0)return;const a=2,d=y.width*a,u=y.height*a;t.clearRect(0,0,d,u),t.imageSmoothingEnabled=!0,t.imageSmoothingQuality="high";const s=x-m;if(s===0){const P=u/2,E=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches;t.strokeStyle=E?"#64748b":"#475569",t.lineWidth=6,t.lineCap="round",t.beginPath(),t.moveTo(6,P),t.lineTo(d-6,P),t.stroke();return}const k=6,l=Math.max(12,d*.35),N=u-k*2,p=d/2,w=p-l/2,z=p+l/2,g=P=>k+(x-P)/s*N,B=h>=c,$=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,T=B?$?"#22c55e":"#16a34a":$?"#ef4444":"#dc2626",F=B?$?"#22c55e":"#15803d":$?"#ef4444":"#b91c1c",L=B?$?"#16a34a":"#14532d":$?"#dc2626":"#991b1b";t.strokeStyle=L,t.lineWidth=6,t.beginPath(),t.moveTo(p,g(x)),t.lineTo(p,g(Math.max(c,h))-1),t.moveTo(p,g(Math.min(c,h))+1),t.lineTo(p,g(m)),t.stroke(),t.strokeStyle=F,t.lineWidth=5,t.lineCap="round",t.beginPath(),t.moveTo(p,g(x)),t.lineTo(p,g(Math.max(c,h))-1),t.moveTo(p,g(Math.min(c,h))+1),t.lineTo(p,g(m)),t.stroke(),t.shadowColor="transparent",t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0;const b=g(Math.max(c,h)),O=g(Math.min(c,h)),M=Math.max(2,O-b);t.shadowColor="rgba(0, 0, 0, 0.15)",t.shadowBlur=3,t.shadowOffsetX=1,t.shadowOffsetY=1;const W=t.createLinearGradient(w,b,w+l,b+M);W.addColorStop(0,T),W.addColorStop(1,T+"88"),t.fillStyle=W;const j=2;t.beginPath(),typeof t.roundRect=="function"?t.roundRect(w,b,l,M,j):t.rect(w,b,l,M),t.fill(),t.shadowColor="transparent",t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0,t.strokeStyle=T,t.lineWidth=2,t.beginPath(),typeof t.roundRect=="function"?t.roundRect(w,b,l,M,j):t.rect(w,b,l,M),t.stroke(),c===h&&(t.strokeStyle=T,t.lineWidth=6,t.lineCap="round",t.beginPath(),t.moveTo(w-3,g(c)),t.lineTo(z+3,g(c)),t.stroke())};return H(()=>y.data,C,{deep:!0}),D(()=>{C()}),(f,t)=>(r(),n("canvas",{ref_key:"canvasRef",ref:i,width:v.width*2,height:v.height*2,style:V({width:v.width+"px",height:v.height+"px"})},null,12,K))}},tt={class:"min-h-screen bg-gray-50 dark:bg-gray-900 py-8"},et={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},st={class:"text-center mb-8"},at={class:"text-4xl font-bold text-gray-900 dark:text-white mb-4"},ot={class:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-7 gap-4 mb-8"},rt={class:"bg-white dark:bg-gray-800 rounded-lg p-4 text-center shadow-sm"},nt={class:"text-2xl font-bold text-gray-900 dark:text-white"},dt={class:"text-sm text-gray-600 dark:text-gray-300"},it={class:"bg-white dark:bg-gray-800 rounded-lg p-4 text-center shadow-sm"},lt={class:"text-2xl font-bold text-blue-600"},ct={class:"text-sm text-gray-600 dark:text-gray-300"},ht={class:"bg-white dark:bg-gray-800 rounded-lg p-4 text-center shadow-sm"},gt={class:"text-2xl font-bold text-orange-600"},xt={class:"text-sm text-gray-600 dark:text-gray-300"},ut={class:"bg-white dark:bg-gray-800 rounded-lg p-4 text-center shadow-sm"},pt={class:"text-2xl font-bold text-green-600"},yt={class:"text-sm text-gray-600 dark:text-gray-300"},_t={class:"bg-white dark:bg-gray-800 rounded-lg p-4 text-center shadow-sm"},mt={class:"text-2xl font-bold text-red-600"},ft={class:"text-sm text-gray-600 dark:text-gray-300"},kt={class:"bg-white dark:bg-gray-800 rounded-lg p-4 text-center shadow-sm"},wt={class:"text-2xl font-bold text-blue-600"},bt={class:"text-sm text-gray-600 dark:text-gray-300"},vt={class:"bg-white dark:bg-gray-800 rounded-lg p-4 text-center shadow-sm"},Ct={class:"text-sm text-gray-600 dark:text-gray-300"},$t={key:0,class:"flex items-center justify-center py-12"},Rt={class:"ml-3 text-gray-600 dark:text-gray-300"},Mt={key:1,class:"text-center py-12"},Tt={class:"text-red-600 dark:text-red-400 mb-4"},Pt={key:2,class:"bg-white dark:bg-gray-800 rounded-lg shadow-sm overflow-hidden"},Bt={class:"overflow-x-auto"},Wt={class:"min-w-full divide-y divide-gray-200 dark:divide-gray-700"},jt={class:"bg-gray-50 dark:bg-gray-700 hidden md:table-header-group"},St={class:"w-1/6 px-4 py-4 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},At={class:"w-1/6 px-4 py-4 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},Dt={class:"w-1/6 px-4 py-4 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},Nt={class:"w-1/6 px-4 py-4 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},zt={class:"w-1/6 px-4 py-4 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},Ft={class:"w-1/6 px-4 py-4 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},Lt={class:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700"},Ot={class:"px-4 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white"},Et={class:"px-4 py-4 whitespace-nowrap text-center"},Ht={key:0,class:"text-gray-400 text-xs"},Vt={class:"px-4 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white text-center"},Xt={class:"px-4 py-4 whitespace-nowrap text-center"},Yt={class:"flex justify-center"},Ut={key:1,class:"text-gray-400 text-xs"},Gt={class:"px-4 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white text-center"},It={key:0,class:"text-gray-400"},qt={key:1,class:"text-gray-400"},Jt={key:3,class:"text-gray-400"},Qt={class:"px-4 py-4 whitespace-nowrap text-center"},Kt={key:1,class:"text-gray-400 text-xs"},Zt={key:1,class:"px-3 py-3 w-full",colspan:"6"},te={class:"flex flex-col space-y-2"},ee={class:"flex items-center justify-between"},se={class:"text-sm font-medium text-gray-900 dark:text-white"},ae={class:"flex items-center space-x-2"},oe={key:0,class:"text-gray-400 text-xs"},re={class:"flex items-center justify-between text-sm"},ne={class:"flex items-center space-x-4"},de={class:"flex items-center space-x-1"},ie={class:"flex items-center space-x-1"},le={key:0,class:"text-gray-400"},ce={key:1,class:"text-gray-400"},he={key:3,class:"text-gray-400"},ge={key:1,class:"text-gray-400 text-xs"},xe={key:0,class:"flex justify-center pt-2"},ue={key:0,class:"text-center py-12"},pe={class:"text-gray-600 dark:text-gray-300"},me={__name:"predictions",setup(v){const y=R([]),i=R({totalRecords:0,tradedCount:0,eventCount:0,longCount:0,shortCount:0,winRate:0,averageProfitRate:null}),C=R(!0),f=R(!1),t=R(0),c=X(()=>t.value<768),x=()=>{t.value=window.innerWidth},m=async()=>{C.value=!0,f.value=!1;try{const a=J(),u=`${a.public.strapiApiUrl||"https://api.dashpull.com"}/api/human-predicts-statistics`,s=a.public.strapiApiToken||"d500bca2021bcb781b01959a2b5c7eca35104ead14e5a1c7a113e1b77030a9d798e3d0ea3be290c20050d000ac5d7c6cc021e57eda01e40b3c545e2d8da2b6c4b75ead96fa5e3ac2cae31ae76de74415371a7928094e271535d1ef786a1f2216e745df26d4aacf85021f5b86c9f2fe92644a9fa5a1f9d63699e43340409661ff",k={"Content-Type":"application/json"};s&&(k.Authorization=`Bearer ${s}`);const l=await $fetch(u,{method:"GET",headers:k,retry:3,timeout:1e4});if(l&&typeof l=="object")y.value=Array.isArray(l.predictions)?l.predictions:[],i.value=l.statistics&&typeof l.statistics=="object"?l.statistics:{totalRecords:0,tradedCount:0,eventCount:0,longCount:0,shortCount:0,winRate:0,averageProfitRate:null};else throw new Error("Invalid response format")}catch(a){console.error("Failed to fetch predictions:",a),f.value=!0,y.value=[],i.value={totalRecords:0,tradedCount:0,eventCount:0,longCount:0,shortCount:0,winRate:0,averageProfitRate:null}}finally{C.value=!1}},h=a=>{try{if(!a)return"";const d=new Date(a);if(isNaN(d.getTime()))return a;const{$i18n:u}=Q();return d.toLocaleDateString(u.locale,{year:"numeric",month:"short",day:"numeric"})}catch(d){return console.warn("Date formatting error:",d),a||""}};return D(()=>{m(),x(),window.addEventListener("resize",x)}),Y(()=>{window.removeEventListener("resize",x)}),q({title:"预测历史 - DashPull",meta:[{name:"description",content:"AI 预测历史记录，查看最近100次预测结果和统计数据"}]}),(a,d)=>{const u=Z;return r(),n("div",tt,[e("div",et,[e("div",st,[e("h1",at,o(a.$t("predictions.title")),1)]),e("div",ot,[e("div",rt,[e("div",nt,o(i.value.totalRecords||0),1),e("div",dt,o(a.$t("predictions.total_records")),1)]),e("div",it,[e("div",lt,o(i.value.tradedCount||0),1),e("div",ct,o(a.$t("predictions.trading_count")),1)]),e("div",ht,[e("div",gt,o(i.value.eventCount||0),1),e("div",xt,o(a.$t("predictions.event_predictions")),1)]),e("div",ut,[e("div",pt,o(i.value.longCount||0),1),e("div",yt,o(a.$t("predictions.long_predictions")),1)]),e("div",_t,[e("div",mt,o(i.value.shortCount||0),1),e("div",ft,o(a.$t("predictions.short_predictions")),1)]),e("div",kt,[e("div",wt,o(i.value.winRate||0)+"%",1),e("div",bt,o(a.$t("predictions.win_rate")),1)]),e("div",vt,[e("div",{class:_(["text-2xl font-bold",(i.value.averageProfitRate||0)>=0?"text-green-600":"text-red-600"])},o(i.value.averageProfitRate!==null?((i.value.averageProfitRate||0)>=0?"+":"")+(i.value.averageProfitRate||0).toFixed(2)+"%":"-"),3),e("div",Ct,o(a.$t("predictions.average_profit_rate")),1)])]),C.value?(r(),n("div",$t,[d[0]||(d[0]=e("div",{class:"w-8 h-8 border-2 border-blue-600 border-t-transparent rounded-full animate-spin"},null,-1)),e("span",Rt,o(a.$t("prediction_component.loading")),1)])):f.value?(r(),n("div",Mt,[e("p",Tt,o(a.$t("prediction_component.error")),1),e("button",{onClick:m,class:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors"},o(a.$t("common.refresh")),1)])):(r(),n("div",Pt,[e("div",Bt,[e("table",Wt,[e("thead",jt,[e("tr",null,[e("th",St,o(a.$t("predictions.date")),1),e("th",At,o(a.$t("predictions.prediction")),1),e("th",Dt,o(a.$t("predictions.long_short_score")),1),e("th",Nt,o(a.$t("predictions.chart")),1),e("th",zt,o(a.$t("predictions.profit_rate")),1),e("th",Ft,o(a.$t("predictions.result")),1)])]),e("tbody",Lt,[(r(!0),n(A,null,U(y.value,(s,k)=>(r(),n("tr",{key:k,class:"hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors"},[c.value?(r(),n("td",Zt,[e("div",te,[e("div",ee,[e("div",se,o(h(s.day)),1),e("div",ae,[s.side?(r(),n("span",{key:1,class:_(["inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium",s.side==="long"?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200"])},o(s.side==="long"?a.$t("prediction_component.side_long"):a.$t("prediction_component.side_short")),3)):(r(),n("span",oe," - "))])]),e("div",re,[e("div",ne,[e("div",de,[d[1]||(d[1]=e("span",{class:"text-gray-500 dark:text-gray-400"},"评分:",-1)),e("span",{class:_((s.market_score||0)>0?"text-green-600":"text-red-600")},o(s.market_score||"-"),3)]),e("div",ie,[d[2]||(d[2]=e("span",{class:"text-gray-500 dark:text-gray-400"},"收益:",-1)),Math.abs(s.market_score||0)<.15?(r(),n("span",le,"-")):s.events&&s.events!=="none"?(r(),n("span",ce,"-")):s.profit_rate!==null&&s.profit_rate!==void 0?(r(),n("span",{key:2,class:_((s.profit_rate||0)>=0?"text-green-600":"text-red-600")},o(((s.profit_rate||0)>=0?"+":"")+(s.profit_rate||0).toFixed(2))+"% ",3)):(r(),n("span",he,"-"))])]),e("div",null,[s.result&&s.result!==null?(r(),n("span",{key:0,class:_(["inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium",s.result==="yes"?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":s.result==="no"?"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200":"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200"])},o(s.result==="yes"?"✓ "+a.$t("predictions.win"):s.result==="no"?"✗ "+a.$t("predictions.loss"):"⊕ "+a.$t("predictions.stop_loss")),3)):(r(),n("span",ge,o(a.$t("predictions.pending")),1))])]),s.spy_kline&&s.spy_kline.length>0?(r(),n("div",xe,[I(u,{data:s.spy_kline[0],width:36,height:32},null,8,["data"])])):S("",!0)])])):(r(),n(A,{key:0},[e("td",Ot,o(h(s.day)),1),e("td",Et,[s.side?(r(),n("span",{key:1,class:_(["inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",s.side==="long"?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200"])},o(s.side==="long"?a.$t("prediction_component.side_long"):a.$t("prediction_component.side_short")),3)):(r(),n("span",Ht," - "))]),e("td",Vt,[e("span",{class:_((s.market_score||0)>0?"text-green-600":"text-red-600")},o(s.market_score||"-"),3)]),e("td",Xt,[e("div",Yt,[s.spy_kline&&s.spy_kline.length>0?(r(),G(u,{key:0,data:s.spy_kline[0],width:40,height:36},null,8,["data"])):(r(),n("span",Ut,"-"))])]),e("td",Gt,[Math.abs(s.market_score||0)<.15?(r(),n("span",It," - ")):s.events&&s.events!=="none"?(r(),n("span",qt," - ")):s.profit_rate!==null&&s.profit_rate!==void 0?(r(),n("span",{key:2,class:_(s.profit_rate>=0?"text-green-600":"text-red-600")},o((s.profit_rate>=0?"+":"")+s.profit_rate.toFixed(2))+"% ",3)):(r(),n("span",Jt," - "))]),e("td",Qt,[s.result&&s.result!==null?(r(),n("span",{key:0,class:_(["inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",s.result==="yes"?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":s.result==="no"?"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200":"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200"])},o(s.result==="yes"?"✓ "+a.$t("predictions.win"):s.result==="no"?"✗ "+a.$t("predictions.loss"):"⊕ "+a.$t("predictions.stop_loss")),3)):(r(),n("span",Kt,o(a.$t("predictions.pending")),1))])],64))]))),128))])])]),y.value.length===0?(r(),n("div",ue,[d[3]||(d[3]=e("div",{class:"text-gray-400 mb-2"},[e("svg",{class:"w-12 h-12 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})])],-1)),e("p",pe,o(a.$t("common.no_data")),1)])):S("",!0)]))])])}}};export{me as default};
